(function() {
  const $newComment = stringToHtml("<%= j render @comment %>")

  <% if @comment.top_level? %>
    const $insertAfterEl = document.querySelector('.new_commment_form')
    $insertAfterEl.parentNode.insertBefore($newComment, $insertAfterEl.nextSibling)
    document.querySelector('.new_commment_form form').reset()

  <% else %>
    const $parentCommentContainer = document.querySelector('#comment_<%= @commentable.id %>')
    const $prependIntoEl = $parentCommentContainer.querySelector('.comments_child_comments')
    $prependIntoEl.prepend($newComment)
    $parentCommentContainer.querySelector('a.cancel').click()

  <% end %>
})()
